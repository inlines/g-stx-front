<h1 class="display-5 fw-bold mb-4 text-light">–ö–∞—Ç–∞–ª–æ–≥</h1>

<div class="row">
  <div class="col-12 px-0 mb-4 sticker">
    <div class="card bg-dark text-white shadow rounded-4 overflow-hidden">
      <div class="p-3">
        <ul class="nav nav-pills flex-wrap justify-content-start mb-3">
          <li class="nav-item me-2 mb-2" *ngFor="let cat of categories">
            <a class="nav-link px-4 py-2 fw-semibold rounded-pill"
              [class.active]="(activeCategory | async) === cat.id"
              (click)="setActiveCategory(cat.id)">
              {{ cat.label }}
            </a>
          </li>
        </ul>
        <form [formGroup]="queryForm">
          <input id="query"
                class="form-control form-control-lg bg-secondary text-white border-0 rounded-3"
                type="text"
                placeholder="üîç –ü–æ–∏—Å–∫ –ø–æ –Ω–∞–∑–≤–∞–Ω–∏—é"
                formControlName="query" />
        </form>
      </div>
    </div>
  </div>
<!-- –ü—Ä–æ–¥—É–∫—Ç—ã -->
<ng-container *ngFor="let product of products$ | async">
  <!-- Desktop / tablet: –∫–∞—Ä—Ç–æ—á–∫–∏ -->
  <div class="col-xl-2 col-lg-3 col-md-4 d-none d-md-block p-3">
    <div
      class="card game-card h-100 border-0 shadow-sm hover-shadow"
      [routerLink]="product.id.toString()"
      style="cursor: pointer;"
    >
      <div
        class="card-img-top bg-dark-subtle d-flex align-items-center justify-content-center"
        style="height: 180px; overflow: hidden;"
      >
        <img
          [src]="product.image_url"
          [alt]="product.name"
          class="img-fluid"
          style="max-height: 100%; object-fit: cover;"
        />
      </div>
      <div class="card-body d-flex flex-column justify-content-between">
        <div>
          <h6 class="card-title text-truncate fw-bold">{{ product.name }}</h6>
          <div class="card-subtitle text-lite-muted small">
            –≤–ø–µ—Ä–≤—ã–µ –≤—ã–ø—É—â–µ–Ω–∞:
            <ng-container *ngIf="product.first_release_date; else never">
              {{ product.first_release_date | date: 'dd.MM.yy' : 'UTC' }}
            </ng-container>
            <ng-template #never>–Ω–∏–∫–æ–≥–¥–∞</ng-template>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Mobile: –≥–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω–∞—è –∫–∞—Ä—Ç–æ—á–∫–∞ -->
  <div class="col-12 d-md-none mb-3">
    <div
      class="card bg-dark text-white shadow-sm rounded-3 d-flex flex-row overflow-hidden"
      [routerLink]="product.id.toString()"
      style="cursor: pointer;"
    >
      <div
        class="flex-shrink-0"
        style="width: 120px; height: 100px; overflow: hidden;"
      >
        <img
          [src]="product.image_url"
          [alt]="product.name"
          class="img-fluid h-100 w-100"
          style="object-fit: cover;"
        />
      </div>
      <div class="p-3 d-flex flex-column justify-content-center">
        <h6 class="mb-1 fw-bold text-truncate" style="max-width: 200px">
          {{ product.name }}
        </h6>
        <small class="text-white-50">
          –≤–ø–µ—Ä–≤—ã–µ –≤—ã–ø—É—â–µ–Ω–∞:
          <ng-container *ngIf="product.first_release_date; else neverMobile">
            {{ product.first_release_date | date: 'dd.MM.yy' : 'UTC' }}
          </ng-container>
          <ng-template #neverMobile>–Ω–∏–∫–æ–≥–¥–∞</ng-template>
        </small>
      </div>
    </div>
  </div>
</ng-container>

  <div class="col-12 mt-4 py-0">
    <app-pager
      (pageChange)="pageChanged($event)"
      [limit]="limit"
      [totalCount]="(productsTotalCount$ | async) || 0">
    </app-pager>
  </div>
</div>
